<!DOCTYPE html>
<html lang="ms-MY">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kemahiran Pemulihan: Konsep Tambah & Lebih Satu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body{box-sizing:border-box}
    .activity-card{min-height:400px}
    .draggable{cursor:grab}
    .draggable:active{cursor:grabbing}
    .drop-zone{border:3px dashed #cbd5e1;transition:all .3s}
    .drop-zone.drag-over{border-color:#3b82f6;background:#dbeafe}
    .marble{width:40px;height:40px;border-radius:50%;display:inline-block;margin:4px;box-shadow:0 2px 4px rgba(0,0,0,.2)}
    .jar{width:120px;height:150px;border:4px solid #8b5cf6;border-radius:0 0 60px 60px;background:linear-gradient(to bottom,transparent 20%,rgba(139,92,246,.1) 100%);position:relative;margin:10px;display:flex;flex-wrap:wrap;align-content:flex-end;justify-content:center;padding:10px}
    .number-line{display:flex;align-items:center;justify-content:center;gap:20px;margin:20px 0}
    .number-box{width:60px;height:60px;border:3px solid #3b82f6;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:bold;background:#fff;cursor:pointer;transition:all .3s}
    .number-box:hover{background:#dbeafe;transform:scale(1.1)}
    .number-box.selected{background:#3b82f6;color:#fff}
    .color-palette{display:flex;gap:10px;margin:20px 0;justify-content:center}
    .color-btn{width:50px;height:50px;border-radius:50%;border:3px solid #374151;cursor:pointer;transition:transform .2s}
    .color-btn:hover{transform:scale(1.1)}
    .colorable{cursor:pointer;transition:all .3s}
    .sequence-item{width:80px;height:80px;border:3px solid #6b7280;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:32px;background:#fff;cursor:pointer;transition:all .3s;margin:5px}
    .sequence-item:hover{transform:scale(1.05);border-color:#3b82f6}
    .sequence-item.correct{background:#dcfce7;border-color:#16a34a}
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
  <!-- Header -->
  <header class="bg-white shadow-sm p-4">
    <div class="max-w-6xl mx-auto">
      <h1 class="text-2xl md:text-3xl font-bold text-gray-800 text-center">ğŸ§® Kemahiran Pemulihan: Konsep Tambah & Lebih Satu</h1>
      <p class="text-center text-gray-600 mt-2">Untuk murid 5â€“9 tahun â€¢ Pembelajaran Interaktif</p>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-4">
    <!-- Info Bar -->
    <div class="bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-6 rounded-r-lg shadow-sm">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <span class="text-2xl mr-3">ğŸ’¡</span>
          <p id="info-text" class="text-lg font-medium text-gray-800">
            Pilih satu aktiviti dan ikut penerangan. Tiada soalan, hanya latihan berpandu.
          </p>
        </div>
        <button id="speak-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-xl transition-colors">ğŸ”Š</button>
      </div>
    </div>

    <!-- Activity Card -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6 activity-card">
      <div id="activity-content">
        <div class="text-center py-20">
          <div class="text-6xl mb-4">ğŸ¯</div>
          <h2 class="text-2xl font-bold text-gray-700 mb-4">Selamat Datang!</h2>
          <p class="text-lg text-gray-600">Pilih aktiviti di bawah untuk meneroka konsep tambah dan â€œlebih satuâ€.</p>
        </div>
      </div>
    </div>

    <!-- Activity Buttons -->
    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
      <button onclick="loadActivity(1)" class="bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-lg font-bold text-lg transition-colors">
        ğŸ«™ Aktiviti 1<br><span class="text-sm font-normal">Guli dalam Balang</span>
      </button>
      <button onclick="loadActivity(2)" class="bg-green-500 hover:bg-green-600 text-white p-4 rounded-lg font-bold text-lg transition-colors">
        ğŸ“ Aktiviti 2<br><span class="text-sm font-normal">Garis Nombor</span>
      </button>
      <button onclick="loadActivity(3)" class="bg-purple-500 hover:bg-purple-600 text-white p-4 rounded-lg font-bold text-lg transition-colors">
        ğŸ¨ Aktiviti 3<br><span class="text-sm font-normal">Warna Tambah</span>
      </button>
      <button onclick="loadActivity(4)" class="bg-orange-500 hover:bg-orange-600 text-white p-4 rounded-lg font-bold text-lg transition-colors">
        ğŸ”¢ Aktiviti 4<br><span class="text-sm font-normal">Susun Nombor</span>
      </button>
      <button onclick="loadActivity(5)" class="bg-pink-500 hover:bg-pink-600 text-white p-4 rounded-lg font-bold text-lg transition-colors">
        ğŸ¯ Aktiviti 5<br><span class="text-sm font-normal">Padankan Jumlah</span>
      </button>
    </div>

    <!-- Control Buttons -->
    <div class="flex justify-center gap-4">
      <button onclick="clearActivity()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-bold transition-colors">ğŸ—‘ï¸ Bersih</button>
      <button onclick="nextActivity()" class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold transition-colors">â¡ï¸ Seterusnya</button>
    </div>
  </main>

  <script>
    let currentActivity = 0;
    let speechSynthesisRef = window.speechSynthesis;
    let isUnlocked = false;
    let currentSelectedColor = '#3b82f6';
    let draggingEl = null;

    // ========== TTS ==========
    function unlockAudio(){
      if(!isUnlocked){
        try{ speechSynthesisRef.speak(new SpeechSynthesisUtterance('')); }catch(e){}
        isUnlocked = true;
      }
    }
    function setInfo(text){ document.getElementById('info-text').textContent = text; }
    function speak(text){
      if(!isUnlocked) return;
      speechSynthesisRef.cancel();
      setTimeout(()=>{
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'ms-MY'; u.rate = 0.8; u.pitch = 1.1;
        const voices = speechSynthesisRef.getVoices();
        const ms = voices.find(v=>v.lang.includes('ms')||v.lang.includes('MY'));
        if(ms) u.voice = ms;
        speechSynthesisRef.speak(u);
      },100);
    }
    document.getElementById('speak-btn').addEventListener('click',()=>{ unlockAudio(); speak(document.getElementById('info-text').textContent); });
    document.addEventListener('click', unlockAudio, {once:true});

    // ========== Aktiviti 1: Guli dalam Balang ==========
    function loadActivity1(){
      setInfo("Seret guli ke dalam balang. Setiap guli yang ditambah meningkatkan jumlah dalam balang.");
      const content = `
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-2">ğŸ«™ Guli dalam Balang</h3>
          <p class="text-lg text-gray-600">Seret guli dari kiri ke dalam balang untuk melihat penambahan jumlah.</p>
        </div>

        <div class="flex flex-wrap justify-center items-center gap-8">
          <div class="text-center">
            <h4 class="text-lg font-bold mb-4">Guli untuk diseret:</h4>
            <div id="marble-source" class="flex flex-wrap justify-center gap-2 p-4 bg-gray-100 rounded-lg min-h-[100px]">
              <div class="marble bg-red-400 draggable" draggable="true" onclick="speakMarble('merah')"></div>
              <div class="marble bg-blue-400 draggable" draggable="true" onclick="speakMarble('biru')"></div>
              <div class="marble bg-green-400 draggable" draggable="true" onclick="speakMarble('hijau')"></div>
              <div class="marble bg-yellow-400 draggable" draggable="true" onclick="speakMarble('kuning')"></div>
              <div class="marble bg-purple-400 draggable" draggable="true" onclick="speakMarble('ungu')"></div>
            </div>
          </div>

          <div class="text-center">
            <h4 class="text-lg font-bold mb-4">Balang:</h4>
            <div class="jar drop-zone" id="jar" onclick="countMarbles()">
              <div class="marble bg-red-400"></div>
              <div class="marble bg-blue-400"></div>
            </div>
            <p class="mt-2 text-lg font-bold">Jumlah dalam balang: <span id="marble-count">2</span> biji</p>
          </div>
        </div>

        <div class="text-center mt-6">
          <p class="text-lg text-gray-700">Mulakan dengan 2 biji guli. Tambahkan guli untuk melihat bagaimana jumlah meningkat.</p>
        </div>
      `;
      document.getElementById('activity-content').innerHTML = content;
      setupDragAndDrop();
    }
    function speakMarble(color){ speak(`Guli warna ${color}`); setInfo(`Ini guli warna ${color}. Seret ke dalam balang.`); }
    function countMarbles(){
      const jar = document.getElementById('jar');
      const count = jar.querySelectorAll('.marble').length;
      document.getElementById('marble-count').textContent = count;
      speak(`Sekarang ada ${count} biji guli dalam balang.`);
      setInfo(`Jumlah terkini dalam balang: ${count} biji.`);
    }
    function setupDragAndDrop(){
      const draggables = document.querySelectorAll('.draggable');
      const dropZone = document.getElementById('jar');

      draggables.forEach(d=>{
        d.addEventListener('dragstart', (e)=>{ draggingEl = e.target; e.dataTransfer.setData('text/plain','drag'); e.dataTransfer.effectAllowed='move'; });
        d.addEventListener('dragend', ()=>{ draggingEl = null; });
      });

      dropZone.addEventListener('dragover', (e)=>{ e.preventDefault(); dropZone.classList.add('drag-over'); });
      dropZone.addEventListener('dragleave', ()=> dropZone.classList.remove('drag-over'));
      dropZone.addEventListener('drop', (e)=>{
        e.preventDefault(); dropZone.classList.remove('drag-over');
        if(draggingEl){
          const copy = draggingEl.cloneNode(true);
          copy.classList.remove('draggable');
          copy.removeAttribute('draggable');
          copy.onclick = null;
          dropZone.appendChild(copy);
          draggingEl.remove();
          countMarbles();
        }
      });
    }

    // ========== Aktiviti 2: Garis Nombor (Lebih Satu) ==========
    function loadActivity2(){
      setInfo("Klik mana-mana nombor pada garis. Sistem akan terangkan â€˜lebih satuâ€™ secara automatik.");
      const line = Array.from({length:10},(_,i)=>`<div class="number-box" onclick="selectNumberOnLine(this, ${i+1})">${i+1}</div>`).join('');
      const content = `
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-2">ğŸ“ Garis Nombor</h3>
          <p class="text-lg text-gray-600">Pemerhatian: â€œLebih satuâ€ bermaksud nombor seterusnya di sebelah kanan.</p>
        </div>
        <div class="number-line">${line}</div>
        <div class="text-center mt-6">
          <div id="number-explanation" class="text-xl font-bold text-gray-700 min-h-[60px] flex items-center justify-center">
            Pilih nombor untuk melihat penjelasan.
          </div>
        </div>
      `;
      document.getElementById('activity-content').innerHTML = content;
    }
    function selectNumberOnLine(el, num){
      document.querySelectorAll('.number-box').forEach(b=>b.classList.remove('selected'));
      el.classList.add('selected');
      const next = num + 1;
      const text = next<=10 ? `Lebih satu daripada ${num} ialah ${next}.` : `${num} ialah hujung garis ini, tiada nombor selepasnya.`;
      document.getElementById('number-explanation').textContent = text;
      setInfo(text); speak(text);

      // Highlight kotak seterusnya (jika ada)
      if(next<=10){
        const nextBox = document.querySelectorAll('.number-box')[next-1];
        nextBox.style.background = '#fbbf24';
        setTimeout(()=>{ nextBox.style.background=''; }, 1800);
      }
    }

    // ========== Aktiviti 3: Warna Tambah ==========
    function loadActivity3(){
      setInfo("Pilih warna dan klik bulatan untuk mewarnakan. Jumlah objek diwarnakan menunjukkan penambahan.");
      const content = `
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-2">ğŸ¨ Warna Tambah</h3>
          <p class="text-lg text-gray-600">Setiap bulatan yang diwarnakan menambah kiraan jumlah.</p>
        </div>

        <div class="color-palette">
          <div class="color-btn bg-red-400"    onclick="selectColor(this,'#f87171')"></div>
          <div class="color-btn bg-blue-400"   onclick="selectColor(this,'#60a5fa')"></div>
          <div class="color-btn bg-green-400"  onclick="selectColor(this,'#4ade80')"></div>
          <div class="color-btn bg-yellow-400" onclick="selectColor(this,'#facc15')"></div>
          <div class="color-btn bg-purple-400" onclick="selectColor(this,'#a78bfa')"></div>
        </div>

        <div class="grid grid-cols-3 md:grid-cols-5 gap-4 justify-items-center mt-8">
          <div class="colorable w-16 h-16 border-4 border-gray-400 rounded-full bg-white" onclick="colorObject(this,'ğŸ')"></div>
          <div class="colorable w-16 h-16 border-4 border-gray-400 rounded-full bg-white" onclick="colorObject(this,'ğŸŠ')"></div>
          <div class="colorable w-16 h-16 border-4 border-gray-400 rounded-full bg-white" onclick="colorObject(this,'ğŸŒ')"></div>
          <div class="colorable w-16 h-16 border-4 border-gray-400 rounded-full bg-white" onclick="colorObject(this,'ğŸ‡')"></div>
          <div class="colorable w-16 h-16 border-4 border-gray-400 rounded-full bg-white" onclick="colorObject(this,'ğŸ“')"></div>
        </div>

        <div class="text-center mt-6">
          <p class="text-xl font-bold">Objek diwarnakan: <span id="colored-count">0</span></p>
          <p class="text-lg text-gray-600 mt-2">Pilih warna dahulu, kemudian klik bulatan untuk mewarnakan.</p>
        </div>
      `;
      document.getElementById('activity-content').innerHTML = content;
    }
    function selectColor(el, color){
      currentSelectedColor = color;
      document.querySelectorAll('.color-btn').forEach(b=>b.style.border='3px solid #374151');
      el.style.border='5px solid #000';
      speak('Warna dipilih. Klik bulatan untuk mewarnakan.');
      setInfo('Warna dipilih. Klik bulatan untuk mewarnakan.');
    }
    function colorObject(el, emoji){
      el.style.backgroundColor = currentSelectedColor;
      el.innerHTML = `<span style="font-size:24px">${emoji}</span>`;
      const count = document.querySelectorAll('.colorable[style*="background-color"]').length;
      document.getElementById('colored-count').textContent = count;
      speak(`Jumlah diwarnakan: ${count}.`);
      setInfo(`Jumlah objek diwarnakan kini ${count}.`);
    }

    // ========== Aktiviti 4: Susun Nombor ==========
    function loadActivity4(){
      setInfo("Klik nombor mengikut urutan 1 hingga 5. Sistem membimbing langkah seterusnya.");
      const content = `
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-2">ğŸ”¢ Susun Nombor</h3>
          <p class="text-lg text-gray-600">Ikut urutan menaik 1, 2, 3, 4, 5.</p>
        </div>
        <div class="flex flex-wrap justify-center gap-4 mb-6">
          <div class="sequence-item" onclick="selectSequence(3, this)">3</div>
          <div class="sequence-item" onclick="selectSequence(1, this)">1</div>
          <div class="sequence-item" onclick="selectSequence(5, this)">5</div>
          <div class="sequence-item" onclick="selectSequence(2, this)">2</div>
          <div class="sequence-item" onclick="selectSequence(4, this)">4</div>
        </div>
        <div class="text-center">
          <p class="text-xl font-bold mb-2">Urutan semasa: <span id="sequence-display">[ ]</span></p>
          <p class="text-lg text-gray-600">Klik nombor seterusnya yang betul.</p>
          <button onclick="resetSequence()" class="mt-4 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">ğŸ”„ Mula Semula</button>
        </div>
      `;
      document.getElementById('activity-content').innerHTML = content;
      window.sequenceOrder = []; window.expectedNext = 1;
    }
    function selectSequence(number, el){
      if(number === window.expectedNext){
        el.classList.add('correct');
        window.sequenceOrder.push(number);
        window.expectedNext++;
        document.getElementById('sequence-display').textContent = `[ ${window.sequenceOrder.join(', ')} ]`;
        if(window.sequenceOrder.length===5){
          speak('Hebat! Urutan menaik lengkap.');
          setInfo('Urutan menaik 1â€“5 telah lengkap.');
        }else{
          speak(`Bagus! Seterusnya nombor ${window.expectedNext}.`);
          setInfo(`Seterusnya klik nombor ${window.expectedNext}.`);
        }
      }else{
        el.style.background='#fecaca';
        setTimeout(()=>{ el.style.background=''; },1000);
        speak(`Belum tepat. Mulakan dengan nombor ${window.expectedNext}.`);
        setInfo(`Belum tepat. Klik nombor ${window.expectedNext} dahulu.`);
      }
    }
    function resetSequence(){
      window.sequenceOrder=[]; window.expectedNext=1;
      document.getElementById('sequence-display').textContent='[ ]';
      document.querySelectorAll('.sequence-item').forEach(i=>{ i.classList.remove('correct'); i.style.background=''; });
      setInfo('Mula semula. Cari 1, kemudian 2, 3, 4, 5.');
    }

    // ========== Aktiviti 5: Padankan Jumlah ==========
    function loadActivity5(){
      setInfo("Pilih satu kumpulan objek, kemudian pilih nombor yang sama banyak. Ini latihan padanan, bukan kuiz.");
      const content = `
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800 mb-2">ğŸ¯ Padankan Jumlah</h3>
          <p class="text-lg text-gray-600">Padankan bilangan objek dengan nombor yang sepadan.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="text-center">
            <h4 class="text-lg font-bold mb-4">Kumpulan Objek:</h4>
            <div class="space-y-4">
              <div class="match-item bg-blue-100 p-4 rounded-lg cursor-pointer"   onclick="selectGroup(1, this)"><span class="text-3xl">ğŸ</span></div>
              <div class="match-item bg-green-100 p-4 rounded-lg cursor-pointer"  onclick="selectGroup(2, this)"><span class="text-3xl">ğŸŠğŸŠ</span></div>
              <div class="match-item bg-yellow-100 p-4 rounded-lg cursor-pointer" onclick="selectGroup(3, this)"><span class="text-3xl">â­â­â­</span></div>
              <div class="match-item bg-purple-100 p-4 rounded-lg cursor-pointer" onclick="selectGroup(4, this)"><span class="text-3xl">ğŸˆğŸˆğŸˆğŸˆ</span></div>
            </div>
          </div>

          <div class="text-center">
            <h4 class="text-lg font-bold mb-4">Nombor:</h4>
            <div class="space-y-4">
              <div class="match-number bg-red-100 p-4 rounded-lg cursor-pointer text-4xl font-bold"    onclick="selectNumberForMatch(4, this)">4</div>
              <div class="match-number bg-orange-100 p-4 rounded-lg cursor-pointer text-4xl font-bold" onclick="selectNumberForMatch(1, this)">1</div>
              <div class="match-number bg-teal-100 p-4 rounded-lg cursor-pointer text-4xl font-bold"   onclick="selectNumberForMatch(3, this)">3</div>
              <div class="match-number bg-pink-100 p-4 rounded-lg cursor-pointer text-4xl font-bold"   onclick="selectNumberForMatch(2, this)">2</div>
            </div>
          </div>
        </div>

        <div class="text-center mt-6">
          <p class="text-gray-600">Latihan ini tidak mengira markah â€” hanya bantu kenal pasti bilangan dengan nombor.</p>
        </div>
      `;
      document.getElementById('activity-content').innerHTML = content;
      window.selectedGroup = null;
    }
    function selectGroup(count, el){
      document.querySelectorAll('.match-item').forEach(i=>i.style.border='');
      el.style.border='4px solid #3b82f6';
      window.selectedGroup = count;
      setInfo(`Kumpulan dipilih mengandungi ${count} objek. Cari nombor ${count}.`);
      speak(`Kumpulan ini ada ${count}. Pilih nombor ${count}.`);
    }
    function selectNumberForMatch(number, el){
      if(window.selectedGroup===null){
        setInfo('Pilih kumpulan objek dahulu.');
        speak('Pilih kumpulan objek dahulu.');
        return;
      }
      if(window.selectedGroup===number){
        el.style.background='#dcfce7'; el.style.border='4px solid #16a34a'; el.onclick=null;
        document.querySelectorAll('.match-item').forEach(item=>{
          if(item.style.border.includes('rgb(59, 130, 246)')){
            item.style.background='#dcfce7'; item.style.border='4px solid #16a34a'; item.onclick=null;
          }
        });
        setInfo('Padanan yang tepat. Teruskan dengan pasangan lain jika ada.');
        speak('Padanan tepat.');
      }else{
        el.style.background='#fecaca'; setTimeout(()=>{ el.style.background=''; },1000);
        setInfo(`Belum tepat. Kumpulan yang dipilih mempunyai ${window.selectedGroup} objek.`);
        speak('Belum tepat. Cuba lagi.');
      }
      window.selectedGroup = null;
      document.querySelectorAll('.match-item').forEach(i=>{ if(!i.style.border.includes('rgb(22, 163, 74)')) i.style.border=''; });
    }

    // ========== Main ==========
    function loadActivity(num){
      currentActivity = num;
      if(num===1) loadActivity1();
      if(num===2) loadActivity2();
      if(num===3) loadActivity3();
      if(num===4) loadActivity4();
      if(num===5) loadActivity5();
    }
    function clearActivity(){
      currentActivity = 0;
      setInfo("Aktiviti dikosongkan. Pilih aktiviti untuk meneruskan latihan.");
      document.getElementById('activity-content').innerHTML = `
        <div class="text-center py-20">
          <div class="text-6xl mb-4">ğŸ§½</div>
          <h2 class="text-2xl font-bold text-gray-700 mb-2">Kawasan Aktiviti Dikemas</h2>
          <p class="text-lg text-gray-600">Pilih salah satu aktiviti di atas untuk sambung belajar.</p>
        </div>
      `;
    }
    function nextActivity(){ const next = currentActivity<5 ? currentActivity+1 : 1; loadActivity(next); }

    document.addEventListener('DOMContentLoaded', ()=>{ setInfo("Selamat datang! Pilih aktiviti untuk meneroka konsep tambah & 'lebih satu'."); });
  </script>
</body>
</html>
